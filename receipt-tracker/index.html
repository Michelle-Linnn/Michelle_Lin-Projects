<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI 智能记账 - Fetch Style</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h2>💰 AI 智能记账</h2>
            <p class="subtitle">支持长收据多图合并扫描</p>
        </header>
        
        <nav class="nav">
            <button onclick="showPage('formPage')" id="navForm" class="active">记账</button>
            <button onclick="showPage('recordsPage')" id="navRecords">历史</button>
            <button onclick="showPage('analysisPage')" id="navAnalysis">分析</button>
        </nav>

        <section id="formPage" class="page-content">
            <div class="ocr-section">
                <div class="upload-area" onclick="document.getElementById('receiptInput').click()">
                    <div class="icon">📸</div>
                    <p>点击拍照或上传</p>
                    <span class="hint">长收据可连续选择多张照片</span>
                </div>
                <input type="file" id="receiptInput" accept="image/*" multiple style="display:none">
                
                <div id="imageQueue" class="image-queue"></div>
                
                <div id="ocrStatus" class="ocr-status">等待上传收据...</div>
                <div class="progress-bar"><div class="progress-bar-fill" id="ocrProgressBar"></div></div>
                
                <button id="startAiBtn" class="btn ai-process-btn" style="display:none;">✨ 开始智能分析 (合并多图)</button>
            </div>

            <div class="currency-toggle">
                <button onclick="setCurrency('USD')" id="currUSD" class="active">💵 USD</button>
                <button onclick="setCurrency('CNY')" id="currCNY">💴 CNY</button>
            </div>

            <div class="input-card">
                <div class="row">
                    <div class="input-group">
                        <label>商家</label>
                        <input type="text" id="merchant" placeholder="AI 自动提取">
                    </div>
                    <div class="input-group">
                        <label>日期</label>
                        <input type="date" id="date">
                    </div>
                </div>

                <div id="itemsList" class="items-list"></div>
                <button class="btn-text" onclick="addItemRow()">+ 添加手动条目</button>

                <div class="total-section">
                    <div class="row">
                        <span>税费 (Tax)</span>
                        <input type="number" id="tax" step="0.01" oninput="updateTotal()" placeholder="0.00">
                    </div>
                    <div class="row main-total">
                        <span>总金额 (<span id="currencySymbol">$</span>)</span>
                        <input type="number" id="amount" step="0.01" placeholder="0.00">
                    </div>
                </div>

                <button class="btn save-btn" id="saveBtn">💾 保存记录</button>
            </div>
        </section>

        <section id="recordsPage" class="page-content" style="display:none;"></section>

        <section id="analysisPage" class="page-content" style="display:none;">
            <canvas id="expenseChart"></canvas>
            <div id="analysisStats" class="stats-list"></div>
        </section>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="app.js"></script>
</body>
</html>